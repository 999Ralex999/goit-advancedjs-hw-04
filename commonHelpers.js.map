{"version":3,"file":"commonHelpers.js","sources":["../src/js/gallery.js","../src/js/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '42355472-3aa41b7abe4d1083b6d3aff39';\naxios.defaults.baseURL = 'https://pixabay.com';\naxios.defaults.params = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n};\n\nexport async function fetchImages(query, page) {\n  const { data } = await axios.get('api/', {\n    params: { q: query, page: page },\n  });\n  return {\n    images: data.hits,\n    totalImages: data.totalHits,\n  };\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './gallery';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst state = {\n  page: 1,\n  query: '',\n  cardHeight: 0,\n};\n\nconst elements = {\n  form: document.querySelector('form'),\n  input: document.querySelector('input'),\n  gallery: document.querySelector('.gallery'),\n  loadMore: document.querySelector('.load-more'),\n};\n\nelements.form.addEventListener('submit', handleSubmit);\nelements.loadMore.addEventListener('click', loadMoreHandler);\n\nfunction notify({ message, type = 'error' }) {\n  iziToast[type]({ message, position: 'topRight' });\n}\n\nfunction toggleLoadMoreButton(isVisible = true) {\n  elements.loadMore.classList.toggle('is-hidden', !isVisible);\n}\n\nasync function fetchAndDisplayImages() {\n  try {\n    const { images, totalImages } = await fetchImages(state.query, state.page);\n\n    if (!images.length) {\n      notify({\n        message:\n          'Sorry, there are no images matching your search query. Please try again.',\n      });\n      return;\n    }\n\n    if (state.page === 1) {\n      notify({\n        message: `Hooray! We found ${totalImages} images.`,\n        type: 'success',\n      });\n    }\n\n    elements.gallery.insertAdjacentHTML(\n      'beforeend',\n      generateMarkupForImages(images)\n    );\n    lightbox.refresh();\n\n    toggleLoadMoreButton(state.page < Math.ceil(totalImages / 40));\n\n    state.cardHeight = elements.gallery.firstElementChild.clientHeight;\n    window.scrollBy({ top: state.cardHeight - 200, behavior: 'smooth' });\n  } catch (error) {\n    notify({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    toggleLoadMoreButton(false);\n  }\n}\n\nfunction handleSubmit(event) {\n  event.preventDefault();\n  toggleLoadMoreButton(false);\n  elements.gallery.innerHTML = '';\n  const searchValue = elements.input.value.trim();\n\n  if (!searchValue) {\n    notify({ message: 'Please enter a search query.' });\n    return;\n  }\n\n  state.query = searchValue;\n  state.page = 1;\n  fetchAndDisplayImages();\n}\n\nfunction loadMoreHandler() {\n  state.page++;\n  fetchAndDisplayImages();\n}\n\nfunction generateMarkupForImages(images) {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        tags,\n      }) => `\n    <a class=\"photo-card\" href=\"${largeImageURL}\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      <div class=\"info\">\n        <p class=\"info-item\"><b>Likes</b> ${likes}</p>\n        <p class=\"info-item\"><b>Views</b> ${views}</p>\n        <p class=\"info-item\"><b>Comments</b> ${comments}</p>\n        <p class=\"info-item\"><b>Downloads</b> ${downloads}</p>\n      </div>\n    </a>`\n    )\n    .join('');\n}\n"],"names":["API_KEY","axios","fetchImages","query","page","data","lightbox","SimpleLightbox","state","elements","handleSubmit","loadMoreHandler","notify","message","type","iziToast","toggleLoadMoreButton","isVisible","fetchAndDisplayImages","images","totalImages","generateMarkupForImages","event","searchValue","largeImageURL","webformatURL","likes","views","comments","downloads","tags"],"mappings":"owBAEA,MAAMA,EAAU,qCAChBC,EAAM,SAAS,QAAU,sBACzBA,EAAM,SAAS,OAAS,CACtB,IAAKD,EACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACZ,EAEO,eAAeE,EAAYC,EAAOC,EAAM,CAC7C,KAAM,CAAE,KAAAC,CAAM,EAAG,MAAMJ,EAAM,IAAI,OAAQ,CACvC,OAAQ,CAAE,EAAGE,EAAO,KAAMC,CAAM,CACpC,CAAG,EACD,MAAO,CACL,OAAQC,EAAK,KACb,YAAaA,EAAK,SACtB,CACA,CCdA,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAQ,CACZ,KAAM,EACN,MAAO,GACP,WAAY,CACd,EAEMC,EAAW,CACf,KAAM,SAAS,cAAc,MAAM,EACnC,MAAO,SAAS,cAAc,OAAO,EACrC,QAAS,SAAS,cAAc,UAAU,EAC1C,SAAU,SAAS,cAAc,YAAY,CAC/C,EAEAA,EAAS,KAAK,iBAAiB,SAAUC,CAAY,EACrDD,EAAS,SAAS,iBAAiB,QAASE,CAAe,EAE3D,SAASC,EAAO,CAAE,QAAAC,EAAS,KAAAC,EAAO,OAAO,EAAI,CAC3CC,EAASD,CAAI,EAAE,CAAE,QAAAD,EAAS,SAAU,UAAU,CAAE,CAClD,CAEA,SAASG,EAAqBC,EAAY,GAAM,CAC9CR,EAAS,SAAS,UAAU,OAAO,YAAa,CAACQ,CAAS,CAC5D,CAEA,eAAeC,GAAwB,CACrC,GAAI,CACF,KAAM,CAAE,OAAAC,EAAQ,YAAAC,CAAW,EAAK,MAAMlB,EAAYM,EAAM,MAAOA,EAAM,IAAI,EAEzE,GAAI,CAACW,EAAO,OAAQ,CAClBP,EAAO,CACL,QACE,0EACV,CAAO,EACD,MACD,CAEGJ,EAAM,OAAS,GACjBI,EAAO,CACL,QAAS,oBAAoBQ,CAAW,WACxC,KAAM,SACd,CAAO,EAGHX,EAAS,QAAQ,mBACf,YACAY,EAAwBF,CAAM,CACpC,EACIb,EAAS,QAAO,EAEhBU,EAAqBR,EAAM,KAAO,KAAK,KAAKY,EAAc,EAAE,CAAC,EAE7DZ,EAAM,WAAaC,EAAS,QAAQ,kBAAkB,aACtD,OAAO,SAAS,CAAE,IAAKD,EAAM,WAAa,IAAK,SAAU,QAAQ,CAAE,CACpE,MAAe,CACdI,EAAO,CACL,QAAS,4DACf,CAAK,EACDI,EAAqB,EAAK,CAC3B,CACH,CAEA,SAASN,EAAaY,EAAO,CAC3BA,EAAM,eAAc,EACpBN,EAAqB,EAAK,EAC1BP,EAAS,QAAQ,UAAY,GAC7B,MAAMc,EAAcd,EAAS,MAAM,MAAM,KAAI,EAE7C,GAAI,CAACc,EAAa,CAChBX,EAAO,CAAE,QAAS,8BAA8B,CAAE,EAClD,MACD,CAEDJ,EAAM,MAAQe,EACdf,EAAM,KAAO,EACbU,GACF,CAEA,SAASP,GAAkB,CACzBH,EAAM,OACNU,GACF,CAEA,SAASG,EAAwBF,EAAQ,CACvC,OAAOA,EACJ,IACC,CAAC,CACC,cAAAK,EACA,aAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,EACA,KAAAC,CACR,IAAY;AAAA,kCACsBN,CAAa;AAAA,kBAC7BC,CAAY,UAAUK,CAAI;AAAA;AAAA,4CAEAJ,CAAK;AAAA,4CACLC,CAAK;AAAA,+CACFC,CAAQ;AAAA,gDACPC,CAAS;AAAA;AAAA,SAGpD,EACA,KAAK,EAAE,CACZ"}